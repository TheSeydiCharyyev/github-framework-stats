<svg xmlns="http://www.w3.org/2000/svg" width="{{ width }}" height="{{ height }}" viewBox="0 0 {{ width }} {{ height }}">
  <defs>
    <style>
      .title { font: 600 14px system-ui, -apple-system, sans-serif; fill: {{ theme.text_primary }}; }
      .badge-text { font: 500 10px system-ui, -apple-system, sans-serif; fill: white; }
    </style>
  </defs>

  <rect width="100%" height="100%" fill="{{ theme.background }}" rx="8"/>

  <!-- Header -->
  <text x="{{ style.padding }}" y="{{ style.padding + 12 }}" class="title">@{{ username }}</text>

  <!-- Badges -->
  {% set badge_y = style.padding + 30 %}
  {% set current_x = style.padding %}
  {% set current_y = badge_y %}
  {% set max_width = width - style.padding * 2 %}

  {% for tech in technologies %}
  {% set badge_width = (tech.name|length * 7) + 20 %}

  <g transform="translate({{ style.padding + (loop.index0 % style.columns) * (style.item_width + style.gap) }}, {{ badge_y + (loop.index0 // style.columns) * (style.item_height + style.gap) }})">
    {% set icon_data = get_icon_data_uri(tech.icon) %}
    <rect width="{{ style.item_width }}" height="{{ style.item_height }}" fill="{{ tech.color }}" rx="4"/>
    {% if icon_data %}
    <image x="4" y="{{ (style.item_height - 16) // 2 }}" width="16" height="16" href="{{ icon_data }}"/>
    <text x="{{ 24 + (style.item_width - 24) // 2 }}" y="{{ style.item_height // 2 + 4 }}" text-anchor="middle" class="badge-text">{{ tech.name[:10] }}</text>
    {% else %}
    <text x="{{ style.item_width // 2 }}" y="{{ style.item_height // 2 + 4 }}" text-anchor="middle" class="badge-text">{{ tech.name[:10] }}</text>
    {% endif %}
  </g>
  {% endfor %}
</svg>
